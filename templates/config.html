{% extends "layout.html" %}

{% block title %} {{ panel_name }} configuration {% endblock %}

{% block content %}

    <h2>configuration: {{ panel_name }}</h2>
    <h4>loaded from: {{ config_file }}</h4>

    <form action="{{ url_for('configure', panel=panel_name) }}" method="POST">

        {% for key, setting in config_params.items() %}
            <label for="{{ key }}">{{ setting["label"] }}:</label>
            {% if setting["type"] == "dropdown" %}
                <select name="{{ key }}" id="{{ key }}">
                    {% for value in setting["values"] %}
                        <option value="{{ value }}" {% if value == setting["set_to"] %}selected{% endif %}>
                            {{ value }}
                        </option>
                    {% endfor %}
                </select>
            {% elif setting["type"] == "serial_port" %}
                <div class="serial-group">
                    <select name="{{ key }}" id="{{ key }}" class="serial_port">

                        {% for value in setting["values"] %}
                            <option value="{{ value }}" {% if value == setting["set_to"] %}selected{% endif %}>
                                {{ value }}
                            </option>
                        {% endfor %}
                    </select>
                    <button type="button"  class="refresh_serial" style="margin-left: 5px;">ðŸ”„</button>
                </div>

            {% elif setting["type"] == "kasa_plug" %} <!-- kasa_plug plugin -->
                <div class="kasa-plug-group">
                    <select name="{{ key }}" id="{{ key }}" class="kasa_plug">

                        {% for value in setting["values"] %}
                            <option value="{{ value }}" {% if value == setting["set_to"] %}selected{% endif %}>
                                {{ value }}
                            </option>
                        {% endfor %}
                    </select>
                    <button type="button"  class="refresh_kasa_plug" style="margin-left: 5px;">ðŸ”„</button>
                </div>
            {% elif setting["type"] == "number" %}
                <input type="number" name="{{ key }}" id="{{ key }}" value="{{ setting["set_to"] }}">
            {% elif setting["type"] == "text" %}
                <input type="text" name="{{ key }}" id="{{ key }}" value="{{ setting["set_to"] }}">
            {% endif %}
            <span style="margin-left: 10px; color: gray;">{{ setting["set_to"] }}</span>
            <br>
        {% endfor %}
            


        <button type="submit">Save Configuration</button>
    </form>


{% endblock %}